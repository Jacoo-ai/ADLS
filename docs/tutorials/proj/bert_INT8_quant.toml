# basics
model = "bert-tiny"
dataset = "sst2"

# 使用 HuggingFace 预训练权重时，指定 load_name 与 load_type
load_name = "prajjwal1/bert-tiny"
load_type = "hf"

max_epochs = 10
batch_size = 32
learning_rate = 1e-3
accelerator = "gpu"
task = "cls"

[transform]
    style = "graph"

[passes.tensorrt]
    by = "type"
    num_calibration_batches = 10
    post_calibration_analysis = true

    [passes.tensorrt.default.config]
        quantize = true
        calibrators = ["percentile", "mse", "entropy"]
        percentiles = [99.0, 99.9, 99.99]
        precision = "int8"

[passes.tensorrt.fine_tune]
    fine_tune = true

[passes.tensorrt.default.input]
    calibrator = "histogram"
    quantize_axis = false

[passes.tensorrt.default.weight]
    calibrator = "histogram"
    quantize_axis = false

[passes.tensorrt.runtime_analysis]
    num_batches = 500
    num_GPU_warmup_batches = 5
    test = true

[cf_args]
# 为 BERT 模型指定 dummy 输入。这里假设 batch_size 为 1，序列长度为 128（实际可根据模型调整）。
# 这里给出的数组仅为示例，通常应满足模型输入的实际尺寸要求。
input_ids = [101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255]
attention_mask = [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
labels = [1]
